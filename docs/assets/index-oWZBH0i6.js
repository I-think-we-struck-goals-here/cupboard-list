(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const $="cupboard-app-state-v1",j=[{name:"Arribato rice",quantity:"1.25",category:"Grains & Pasta"},{name:"Microwave rice",quantity:"2",category:"Grains & Pasta"},{name:"Couscous",quantity:"2",category:"Grains & Pasta"},{name:"Penne Pasta",quantity:"1",category:"Grains & Pasta"},{name:"Rigatoni",quantity:"0.5",category:"Other"},{name:"Medium egg noodles",quantity:"0.5",category:"Grains & Pasta"},{name:"Risotto truffle kit",quantity:"1",category:"Grains & Pasta"},{name:"Miso paste",quantity:"1",category:"Spices & Seasonings"},{name:"Capsicana hot honey",quantity:"1",category:"Sauces & Condiments"},{name:"Garlic seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"BBQ seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"Lentil vertes",quantity:"1",category:"Legumes & Flours"},{name:"Red lentils",quantity:"1",category:"Legumes & Flours"},{name:"Gram flour",quantity:"1",category:"Legumes & Flours"},{name:"Hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Sweet hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Texas BBQ sauce",quantity:"1.25",category:"Sauces & Condiments"},{name:"Korean hot sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Caramel sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Kewpie",quantity:"1",category:"Sauces & Condiments"},{name:"Peanut butter",quantity:"2",category:"Canned Goods"},{name:"Chilli paste",quantity:"1",category:"Sauces & Condiments"},{name:"Mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Grainy mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Chicken korma paste",quantity:"1",category:"Sauces & Condiments"},{name:"Cuppa soup chicken",quantity:"2",category:"Canned Goods"},{name:"Bread crumbs",quantity:"1",category:"Canned Goods"},{name:"Chickpeas",quantity:"1",category:"Legumes & Flours"},{name:"Red cabbage jar",quantity:"1",category:"Canned Goods"},{name:"Gherkins",quantity:"1",category:"Canned Goods"},{name:"Black beans",quantity:"4",category:"Canned Goods"},{name:"Chopped tomatoes",quantity:"1",category:"Canned Goods"},{name:"Coconut cream",quantity:"2",category:"Canned Goods"},{name:"Peach slices",quantity:"1",category:"Canned Goods"},{name:"Tuna tin",quantity:"1",category:"Canned Goods"},{name:"Baked beans",quantity:"1",category:"Canned Goods"},{name:"Chicken gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Vegan gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Chicken stock",quantity:"1",category:"Stock & Gravy"},{name:"Vegetable stock",quantity:"1",category:"Stock & Gravy"},{name:"Beef stock",quantity:"1",category:"Stock & Gravy"}],L="1",y=["Canned Goods","Grains & Pasta","Legumes & Flours","Sauces & Condiments","Spices & Seasonings","Stock & Gravy","Other"],I=new Intl.Collator(void 0,{sensitivity:"base",numeric:!0}),Y=document.querySelector("#summary"),P=document.querySelector("#filter-bar"),G=document.querySelector("#items-body"),X=document.querySelector("#row-template"),Z=document.querySelector("#add-section"),U=document.querySelector("#new-item-form"),T=document.querySelector("#form-message"),Q=document.querySelector("#new-name"),ee=document.querySelector("#new-quantity"),k=document.querySelector("#new-low-level"),g=document.querySelector("#new-category-select"),te=document.querySelector("#new-custom-category-wrap"),_=document.querySelector("#new-custom-category"),u=document.querySelector("#edit-dialog"),ne=document.querySelector("#edit-item-form"),H=document.querySelector("#edit-name"),K=document.querySelector("#edit-low-level"),f=document.querySelector("#edit-category-select"),oe=document.querySelector("#edit-custom-category-wrap"),w=document.querySelector("#edit-custom-category"),ae=document.querySelector("#cancel-edit"),B=document.querySelector("#edit-message"),x=document.querySelector("#search-input"),re=document.querySelector("#fab-add-button");let i=ie(),C=null,N="",l="all";function A(){return globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`}function v(e){if(e==null)return null;const t=String(e).trim().replace(",",".");if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}function b(e){const t=v(e.quantity),n=v(e.lowLevel);return t===null||n===null?!1:t<=n}function se(){return j.map(e=>({id:A(),name:e.name,quantity:e.quantity,lowLevel:L,category:e.category}))}function ce(e){const t=new Set(y);for(const n of e)t.add(n.category);return[...t].sort((n,o)=>n.localeCompare(o))}function ie(){const e=se(),t=ce(e);try{const n=localStorage.getItem($);if(!n)return{items:e,customCategories:t.filter(a=>!y.includes(a))};const o=JSON.parse(n),r=Array.isArray(o.items)?o.items.filter(a=>a&&a.name&&a.category).map(a=>({id:a.id||A(),name:String(a.name).trim(),quantity:String(a.quantity??""),lowLevel:String(a.lowLevel??L),category:String(a.category).trim()})):e,s=Array.isArray(o.customCategories)?o.customCategories.map(a=>String(a).trim()).filter(Boolean):[];return{items:r,customCategories:s}}catch{return{items:e,customCategories:t.filter(n=>!y.includes(n))}}}function M(){localStorage.setItem($,JSON.stringify(i))}function W(){const e=new Set([...y,...i.customCategories]);for(const t of i.items)e.add(t.category);return[...e].sort((t,n)=>t.localeCompare(n))}function ue(){const e=N.trim().toLowerCase();return i.items.filter(t=>{if(!(l==="all"||l==="low"&&b(t)||t.category===l))return!1;if(!e)return!0;const o=t.name.toLowerCase(),r=t.category.toLowerCase();return o.includes(e)||r.includes(e)})}function le(){const e=new Map;for(const n of ue()){const o=n.category;e.has(o)||e.set(o,[]),e.get(o).push(n)}return[...e.keys()].sort((n,o)=>I.compare(n,o)).map(n=>{const o=e.get(n).slice().sort((r,s)=>{const a=I.compare(r.name.trim(),s.name.trim());return a!==0?a:I.compare(r.id,s.id)});return{category:n,items:o}})}function D(e,t){const n=W();e.innerHTML="";for(const r of n){const s=document.createElement("option");s.value=r,s.textContent=r,e.append(s)}const o=document.createElement("option");o.value="__custom__",o.textContent="+ Create new category",e.append(o),t&&[...e.options].some(r=>r.value===t)&&(e.value=t)}function z(){D(g,g.value),D(f,f.value)}function me(){const e=i.items.filter(n=>b(n)).length,t=[{value:"all",label:"All"},{value:"low",label:"Low",badge:e>0?String(e):""},...W().map(n=>({value:n,label:n}))];t.some(n=>n.value===l)||(l="all"),P.innerHTML="";for(const n of t){const o=document.createElement("button");o.type="button",o.className=`filter-chip${l===n.value?" active":""}`,o.setAttribute("role","radio"),o.setAttribute("aria-checked",l===n.value?"true":"false"),o.dataset.filter=n.value;const r=document.createElement("span");if(r.textContent=n.label,o.append(r),n.badge){const s=document.createElement("span");s.className="low-badge",s.textContent=n.badge,o.append(s)}o.addEventListener("click",()=>{l=n.value,q()}),P.append(o)}}function R(){const e=i.items.filter(t=>b(t)).length;Y.textContent=`${i.items.length} items â€¢ ${e} low`}function J(){const e=le();if(G.innerHTML="",e.length===0){const t=document.createElement("p");t.className="empty-state",t.textContent=N?"No items match your search.":"No items yet. Add your first cupboard item below.",G.append(t),R();return}for(const t of e){const n=document.createElement("section");n.className="category-section";const o=document.createElement("div");o.className="category-header";const r=document.createElement("span");r.textContent=t.category;const s=document.createElement("span");s.className="category-count",s.textContent=`${t.items.length} item${t.items.length===1?"":"s"}`,o.append(r,s);const a=document.createElement("div");a.className="items-list",a.setAttribute("role","list");for(const m of t.items){const c=X.content.firstElementChild.cloneNode(!0),p=c.querySelector('[data-field="name"]'),E=c.querySelector('[data-field="quantity"]'),V=c.querySelector('[data-action="edit"]');p.textContent=m.name,E.value=m.quantity,c.classList.toggle("low",b(m)),E.addEventListener("change",()=>{m.quantity=E.value.trim(),M(),q()}),V.addEventListener("click",()=>{de(m.id)}),a.append(c)}n.append(o,a),G.append(n)}R()}function d(e,t="ok"){T.textContent=e,T.dataset.tone=t}function F(){const e=g.value==="__custom__";te.classList.toggle("hidden",!e),_.required=e,e&&_.focus()}function S(e,t="ok"){B.textContent=e,B.dataset.tone=t}function O(){const e=f.value==="__custom__";oe.classList.toggle("hidden",!e),w.required=e,e||(w.value="")}function de(e){const t=i.items.find(n=>n.id===e);t&&(C=e,z(),H.value=t.name,K.value=t.lowLevel,f.value=t.category,w.value="",O(),S("Update details and save."),typeof u.showModal=="function"?u.showModal():u.setAttribute("open",""))}function h(){C=null,typeof u.close=="function"?u.close():u.removeAttribute("open")}function ye(e){if(e.preventDefault(),!C)return;const t=i.items.find(c=>c.id===C);if(!t){h();return}const n=H.value.trim(),o=K.value.trim(),r=f.value,s=w.value.trim(),a=r==="__custom__"?s:r;if(!n||!o||!a){S("Please complete all fields.","error");return}if(v(o)===null){S("Running low level must be a number.","error");return}if(i.items.some(c=>c.id!==t.id&&c.name.toLowerCase()===n.toLowerCase()&&c.category.toLowerCase()===a.toLowerCase())){S("That item already exists in this category.","error");return}t.name=n,t.lowLevel=o,t.category=a,!y.includes(a)&&!i.customCategories.includes(a)&&(i.customCategories.push(a),i.customCategories.sort((c,p)=>c.localeCompare(p))),M(),h(),q(),d(`Updated ${n}.`,"ok")}function ge(e){e.preventDefault();const t=Q.value.trim(),n=ee.value.trim(),o=k.value.trim(),r=g.value,s=_.value.trim();let a=r;if(r==="__custom__"&&(a=s),!t||!n||!o||!a){d("Please complete all fields.","error");return}if(v(n)===null||v(o)===null){d("Quantity and low level must be numbers.","error");return}if(i.items.some(c=>c.name.toLowerCase()===t.toLowerCase()&&c.category.toLowerCase()===a.toLowerCase())){d("That item already exists in this category.","error");return}i.items.push({id:A(),name:t,quantity:n,lowLevel:o,category:a}),!y.includes(a)&&!i.customCategories.includes(a)&&(i.customCategories.push(a),i.customCategories.sort((c,p)=>c.localeCompare(p))),M(),q(),U.reset(),k.value=L,g.value=a,F(),d(`Added ${t}.`,"ok")}function fe(){x.addEventListener("input",()=>{N=x.value,J()}),re.addEventListener("click",()=>{Z.scrollIntoView({behavior:"smooth",block:"start"}),window.setTimeout(()=>{Q.focus()},200)}),g.addEventListener("change",F),U.addEventListener("submit",ge),f.addEventListener("change",O),ne.addEventListener("submit",ye),ae.addEventListener("click",h),u.addEventListener("cancel",()=>{C=null}),u.addEventListener("click",e=>{e.target===u&&h()})}function q(){z(),me(),F(),O(),J()}k.value=L;fe();q();d("Ready.");
