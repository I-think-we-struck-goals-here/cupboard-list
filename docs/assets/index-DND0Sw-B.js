(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const Y="cupboard-app-state-v1",de=[{name:"Arribato rice",quantity:"1.25",category:"Grains & Pasta"},{name:"Microwave rice",quantity:"2",category:"Grains & Pasta"},{name:"Couscous",quantity:"2",category:"Grains & Pasta"},{name:"Penne Pasta",quantity:"1",category:"Grains & Pasta"},{name:"Rigatoni",quantity:"0.5",category:"Other"},{name:"Medium egg noodles",quantity:"0.5",category:"Grains & Pasta"},{name:"Risotto truffle kit",quantity:"1",category:"Grains & Pasta"},{name:"Miso paste",quantity:"1",category:"Spices & Seasonings"},{name:"Capsicana hot honey",quantity:"1",category:"Sauces & Condiments"},{name:"Garlic seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"BBQ seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"Lentil vertes",quantity:"1",category:"Legumes & Flours"},{name:"Red lentils",quantity:"1",category:"Legumes & Flours"},{name:"Gram flour",quantity:"1",category:"Legumes & Flours"},{name:"Hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Sweet hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Texas BBQ sauce",quantity:"1.25",category:"Sauces & Condiments"},{name:"Korean hot sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Caramel sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Kewpie",quantity:"1",category:"Sauces & Condiments"},{name:"Peanut butter",quantity:"2",category:"Canned Goods"},{name:"Chilli paste",quantity:"1",category:"Sauces & Condiments"},{name:"Mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Grainy mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Chicken korma paste",quantity:"1",category:"Sauces & Condiments"},{name:"Cuppa soup chicken",quantity:"2",category:"Canned Goods"},{name:"Bread crumbs",quantity:"1",category:"Canned Goods"},{name:"Chickpeas",quantity:"1",category:"Legumes & Flours"},{name:"Red cabbage jar",quantity:"1",category:"Canned Goods"},{name:"Gherkins",quantity:"1",category:"Canned Goods"},{name:"Black beans",quantity:"4",category:"Canned Goods"},{name:"Chopped tomatoes",quantity:"1",category:"Canned Goods"},{name:"Coconut cream",quantity:"2",category:"Canned Goods"},{name:"Peach slices",quantity:"1",category:"Canned Goods"},{name:"Tuna tin",quantity:"1",category:"Canned Goods"},{name:"Baked beans",quantity:"1",category:"Canned Goods"},{name:"Chicken gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Vegan gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Chicken stock",quantity:"1",category:"Stock & Gravy"},{name:"Vegetable stock",quantity:"1",category:"Stock & Gravy"},{name:"Beef stock",quantity:"1",category:"Stock & Gravy"}],X="1",Z="0",p=["Canned Goods","Grains & Pasta","Legumes & Flours","Sauces & Condiments","Spices & Seasonings","Stock & Gravy","Other"],A=new Intl.Collator(void 0,{sensitivity:"base",numeric:!0}),W=document.querySelector("#filter-bar"),z=document.querySelector("#search-panel"),B=document.querySelector("#search-toggle-btn"),me=document.querySelector("#clear-search-btn"),x=document.querySelector("#items-body"),ye=document.querySelector("#row-template"),ge=document.querySelector("#add-section"),ee=document.querySelector("#new-item-form"),H=document.querySelector("#form-message"),te=document.querySelector("#new-name"),fe=document.querySelector("#new-quantity"),F=document.querySelector("#new-low-level"),S=document.querySelector("#new-category-select"),pe=document.querySelector("#new-custom-category-wrap"),O=document.querySelector("#new-custom-category"),l=document.querySelector("#edit-dialog"),Ce=document.querySelector("#edit-item-form"),ne=document.querySelector("#edit-name"),oe=document.querySelector("#edit-low-level"),h=document.querySelector("#edit-category-select"),ve=document.querySelector("#edit-custom-category-wrap"),T=document.querySelector("#edit-custom-category"),qe=document.querySelector("#delete-item-button"),Se=document.querySelector("#cancel-edit"),K=document.querySelector("#edit-message"),ae=document.querySelector("#undo-toast"),he=document.querySelector("#undo-toast-message"),Le=document.querySelector("#undo-delete-button"),q=document.querySelector("#search-input"),we=document.querySelector("#top-add-button");let c=Ie(),C=null,L="",b=!1,m="all",_=null,k=null;function D(){return globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`}function v(e){if(e==null)return null;const t=String(e).trim().replace(",",".");if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}function V(e){return Number(e.toFixed(3)).toString()}function J(e){return String(e??"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim()}function re(e){const t=v(e.quantity),n=v(e.lowLevel);return t===null||n===null?!1:t<=n}function be(){return de.map(e=>({id:D(),name:e.name,quantity:e.quantity,lowLevel:X,category:e.category}))}function Ee(e){const t=new Set(p);for(const n of e)t.add(n.category);return[...t].sort((n,a)=>n.localeCompare(a))}function Ie(){const e=be(),t=Ee(e);try{const n=localStorage.getItem(Y);if(!n)return{items:e,customCategories:t.filter(o=>!p.includes(o))};const a=JSON.parse(n),r=Array.isArray(a.items)?a.items.filter(o=>o&&o.name&&o.category).map(o=>({id:o.id||D(),name:String(o.name).trim(),quantity:String(o.quantity??""),lowLevel:String(o.lowLevel??X),category:String(o.category).trim()})):e,s=Array.isArray(a.customCategories)?a.customCategories.map(o=>String(o).trim()).filter(Boolean):[];return{items:r,customCategories:s}}catch{return{items:e,customCategories:t.filter(n=>!p.includes(n))}}}function f(){localStorage.setItem(Y,JSON.stringify(c))}function se(){const e=new Set([...p,...c.customCategories]);for(const t of c.items)e.add(t.category);return[...e].sort((t,n)=>t.localeCompare(n))}function ke(){const e=J(L).split(/\s+/).filter(Boolean);return c.items.filter(t=>{const n=m==="all"||m==="low"&&re(t)||t.category===m;if(e.length===0)return n;const a=J(`${t.name} ${t.category}`);return e.every(r=>a.includes(r))})}function Ge(){const e=new Map;for(const n of ke()){const a=n.category;e.has(a)||e.set(a,[]),e.get(a).push(n)}return[...e.keys()].sort((n,a)=>A.compare(n,a)).map(n=>{const a=e.get(n).slice().sort((r,s)=>{const o=A.compare(r.name.trim(),s.name.trim());return o!==0?o:A.compare(r.id,s.id)});return{category:n,items:a}})}function j(e,t){const n=se();e.innerHTML="";for(const r of n){const s=document.createElement("option");s.value=r,s.textContent=r,e.append(s)}const a=document.createElement("option");a.value="__custom__",a.textContent="+ Create new category",e.append(a),t&&[...e.options].some(r=>r.value===t)&&(e.value=t)}function ce(){j(S,S.value),j(h,h.value)}function Te(){const e=[{value:"all",label:"All"},{value:"low",label:"Low"},...se().map(t=>({value:t,label:t}))];e.some(t=>t.value===m)||(m="all"),W.innerHTML="";for(const t of e){const n=document.createElement("button");n.type="button",n.className=`filter-chip${m===t.value?" active":""}`,n.setAttribute("role","radio"),n.setAttribute("aria-checked",m===t.value?"true":"false"),n.dataset.filter=t.value;const a=document.createElement("span");a.textContent=t.label,n.append(a),n.addEventListener("click",()=>{m=t.value,d()}),W.append(n)}}function R(){const e=Ge();if(x.innerHTML="",e.length===0){const t=document.createElement("p");t.className="empty-state",t.textContent=L?"No items match your search.":"No items yet. Add your first cupboard item below.",x.append(t);return}for(const t of e){const n=document.createElement("section");n.className="category-section";const a=document.createElement("div");a.className="category-header";const r=document.createElement("span");r.textContent=t.category,a.append(r);const s=document.createElement("div");s.className="items-list",s.setAttribute("role","list");for(const o of t.items){const u=ye.content.firstElementChild.cloneNode(!0),i=u.querySelector('[data-field="name"]'),g=u.querySelector('[data-field="quantity"]'),ie=u.querySelector('[data-action="decrease"]'),ue=u.querySelector('[data-action="increase"]'),le=u.querySelector('[data-action="edit"]');i.textContent=o.name,g.value=o.quantity,u.classList.toggle("low",re(o)),g.addEventListener("change",()=>{o.quantity=g.value.trim(),f(),d()}),ie.addEventListener("click",()=>{const Q=v(o.quantity)??0,M=Math.max(0,Q-1);o.quantity=V(M),f(),d()}),ue.addEventListener("click",()=>{const M=(v(o.quantity)??0)+1;o.quantity=V(M),f(),d()}),le.addEventListener("click",()=>{Ae(o.id)}),s.append(u)}n.append(a,s),x.append(n)}}function y(e,t="ok"){H.textContent=e,H.dataset.tone=t}function _e(){k!==null&&(window.clearTimeout(k),k=null)}function P(e=!0){_e(),ae.classList.remove("open"),e&&(_=null)}function Ne(e,t){P(!1),_={item:e,index:t},he.textContent=`Removed ${e.name}.`,ae.classList.add("open"),k=window.setTimeout(()=>{P(!0)},3e3)}function Me(){if(!_)return;const{item:e,index:t}=_,n=Math.max(0,Math.min(t,c.items.length));c.items.splice(n,0,e),!p.includes(e.category)&&!c.customCategories.includes(e.category)&&(c.customCategories.push(e.category),c.customCategories.sort((a,r)=>a.localeCompare(r))),f(),P(!0),d(),y(`Restored ${e.name}.`,"ok")}function N(){const e=L.trim().length>0;z.classList.toggle("open",b),z.classList.toggle("has-query",e),B.classList.toggle("active",b||e),B.setAttribute("aria-expanded",b?"true":"false")}function E(e,t={}){b=e,N(),e&&t.focus&&window.setTimeout(()=>{q.focus()},120)}function I(){L="",q.value="",R(),N()}function U(){const e=S.value==="__custom__";pe.classList.toggle("hidden",!e),O.required=e,e&&O.focus()}function G(e,t="ok"){K.textContent=e,K.dataset.tone=t}function $(){const e=h.value==="__custom__";ve.classList.toggle("hidden",!e),T.required=e,e||(T.value="")}function Ae(e){const t=c.items.find(n=>n.id===e);t&&(C=e,ce(),ne.value=t.name,oe.value=t.lowLevel,h.value=t.category,T.value="",$(),G("Update details and save."),typeof l.showModal=="function"?l.showModal():l.setAttribute("open",""))}function w(){C=null,typeof l.close=="function"?l.close():l.removeAttribute("open")}function xe(e){if(e.preventDefault(),!C)return;const t=c.items.find(i=>i.id===C);if(!t){w();return}const n=ne.value.trim(),a=oe.value.trim(),r=h.value,s=T.value.trim(),o=r==="__custom__"?s:r;if(!n||!a||!o){G("Please complete all fields.","error");return}if(v(a)===null){G("Running low level must be a number.","error");return}if(c.items.some(i=>i.id!==t.id&&i.name.toLowerCase()===n.toLowerCase()&&i.category.toLowerCase()===o.toLowerCase())){G("That item already exists in this category.","error");return}t.name=n,t.lowLevel=a,t.category=o,!p.includes(o)&&!c.customCategories.includes(o)&&(c.customCategories.push(o),c.customCategories.sort((i,g)=>i.localeCompare(g))),f(),w(),d(),y(`Updated ${n}.`,"ok")}function Be(){if(!C)return;const e=c.items.findIndex(n=>n.id===C);if(e<0){w();return}const[t]=c.items.splice(e,1);f(),w(),d(),Ne(t,e),y(`Removed ${t.name}.`,"ok")}function Fe(e){e.preventDefault();const t=te.value.trim(),n=fe.value.trim(),a=F.value.trim(),r=S.value,s=O.value.trim();let o=r;if(r==="__custom__"&&(o=s),!t||!n||!a||!o){y("Please complete all fields.","error");return}if(v(n)===null||v(a)===null){y("Quantity and low level must be numbers.","error");return}if(c.items.some(i=>i.name.toLowerCase()===t.toLowerCase()&&i.category.toLowerCase()===o.toLowerCase())){y("That item already exists in this category.","error");return}c.items.push({id:D(),name:t,quantity:n,lowLevel:a,category:o}),!p.includes(o)&&!c.customCategories.includes(o)&&(c.customCategories.push(o),c.customCategories.sort((i,g)=>i.localeCompare(g))),f(),d(),ee.reset(),F.value=Z,S.value=o,U(),y(`Added ${t}.`,"ok")}function Oe(){q.addEventListener("input",()=>{L=q.value,R(),N()}),q.addEventListener("keydown",e=>{if(e.key==="Escape"){if(L.trim()){I();return}E(!1)}}),B.addEventListener("click",()=>{if(b){I(),E(!1);return}E(!0,{focus:!0})}),me.addEventListener("click",()=>{I(),q.focus()}),we.addEventListener("click",()=>{I(),E(!1),ge.scrollIntoView({behavior:"smooth",block:"start"}),window.setTimeout(()=>{te.focus()},200)}),S.addEventListener("change",U),ee.addEventListener("submit",Fe),h.addEventListener("change",$),qe.addEventListener("click",Be),Ce.addEventListener("submit",xe),Se.addEventListener("click",w),Le.addEventListener("click",Me),l.addEventListener("cancel",()=>{C=null}),l.addEventListener("click",e=>{e.target===l&&w()})}function d(){ce(),Te(),U(),$(),R(),N()}F.value=Z;Oe();d();y("Ready.");
