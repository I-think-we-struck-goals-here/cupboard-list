(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const $="cupboard-app-state-v1",J=[{name:"Arribato rice",quantity:"1.25",category:"Grains & Pasta"},{name:"Microwave rice",quantity:"2",category:"Grains & Pasta"},{name:"Couscous",quantity:"2",category:"Grains & Pasta"},{name:"Penne Pasta",quantity:"1",category:"Grains & Pasta"},{name:"Rigatoni",quantity:"0.5",category:"Other"},{name:"Medium egg noodles",quantity:"0.5",category:"Grains & Pasta"},{name:"Risotto truffle kit",quantity:"1",category:"Grains & Pasta"},{name:"Miso paste",quantity:"1",category:"Spices & Seasonings"},{name:"Capsicana hot honey",quantity:"1",category:"Sauces & Condiments"},{name:"Garlic seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"BBQ seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"Lentil vertes",quantity:"1",category:"Legumes & Flours"},{name:"Red lentils",quantity:"1",category:"Legumes & Flours"},{name:"Gram flour",quantity:"1",category:"Legumes & Flours"},{name:"Hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Sweet hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Texas BBQ sauce",quantity:"1.25",category:"Sauces & Condiments"},{name:"Korean hot sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Caramel sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Kewpie",quantity:"1",category:"Sauces & Condiments"},{name:"Peanut butter",quantity:"2",category:"Canned Goods"},{name:"Chilli paste",quantity:"1",category:"Sauces & Condiments"},{name:"Mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Grainy mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Chicken korma paste",quantity:"1",category:"Sauces & Condiments"},{name:"Cuppa soup chicken",quantity:"2",category:"Canned Goods"},{name:"Bread crumbs",quantity:"1",category:"Canned Goods"},{name:"Chickpeas",quantity:"1",category:"Legumes & Flours"},{name:"Red cabbage jar",quantity:"1",category:"Canned Goods"},{name:"Gherkins",quantity:"1",category:"Canned Goods"},{name:"Black beans",quantity:"4",category:"Canned Goods"},{name:"Chopped tomatoes",quantity:"1",category:"Canned Goods"},{name:"Coconut cream",quantity:"2",category:"Canned Goods"},{name:"Peach slices",quantity:"1",category:"Canned Goods"},{name:"Tuna tin",quantity:"1",category:"Canned Goods"},{name:"Baked beans",quantity:"1",category:"Canned Goods"},{name:"Chicken gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Vegan gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Chicken stock",quantity:"1",category:"Stock & Gravy"},{name:"Vegetable stock",quantity:"1",category:"Stock & Gravy"},{name:"Beef stock",quantity:"1",category:"Stock & Gravy"}],L="1",y=["Canned Goods","Grains & Pasta","Legumes & Flours","Sauces & Condiments","Spices & Seasonings","Stock & Gravy","Other"],E=new Intl.Collator(void 0,{sensitivity:"base",numeric:!0}),j=document.querySelector("#summary"),I=document.querySelector("#items-body"),Y=document.querySelector("#row-template"),X=document.querySelector("#add-section"),Q=document.querySelector("#new-item-form"),B=document.querySelector("#form-message"),K=document.querySelector("#new-name"),Z=document.querySelector("#new-quantity"),G=document.querySelector("#new-low-level"),g=document.querySelector("#new-category-select"),ee=document.querySelector("#new-custom-category-wrap"),k=document.querySelector("#new-custom-category"),l=document.querySelector("#edit-dialog"),te=document.querySelector("#edit-item-form"),H=document.querySelector("#edit-name"),V=document.querySelector("#edit-low-level"),f=document.querySelector("#edit-category-select"),ne=document.querySelector("#edit-custom-category-wrap"),S=document.querySelector("#edit-custom-category"),oe=document.querySelector("#cancel-edit"),F=document.querySelector("#edit-message"),R=document.querySelector("#search-input"),ae=document.querySelector("#fab-add-button");let i=ce(),C=null,_="";function N(){return globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`}function m(e){if(e==null)return null;const t=String(e).trim().replace(",",".");if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}function v(e){const t=m(e.quantity),n=m(e.lowLevel);return t===null||n===null?!1:t<=n}function W(e){return m(e.quantity)!==null&&m(e.lowLevel)!==null}function re(){return J.map(e=>({id:N(),name:e.name,quantity:e.quantity,lowLevel:L,category:e.category}))}function se(e){const t=new Set(y);for(const n of e)t.add(n.category);return[...t].sort((n,a)=>n.localeCompare(a))}function ce(){const e=re(),t=se(e);try{const n=localStorage.getItem($);if(!n)return{items:e,customCategories:t.filter(o=>!y.includes(o))};const a=JSON.parse(n),r=Array.isArray(a.items)?a.items.filter(o=>o&&o.name&&o.category).map(o=>({id:o.id||N(),name:String(o.name).trim(),quantity:String(o.quantity??""),lowLevel:String(o.lowLevel??L),category:String(o.category).trim()})):e,s=Array.isArray(a.customCategories)?a.customCategories.map(o=>String(o).trim()).filter(Boolean):[];return{items:r,customCategories:s}}catch{return{items:e,customCategories:t.filter(n=>!y.includes(n))}}}function M(){localStorage.setItem($,JSON.stringify(i))}function ie(){const e=new Set([...y,...i.customCategories]);for(const t of i.items)e.add(t.category);return[...e].sort((t,n)=>t.localeCompare(n))}function ue(){const e=_.trim().toLowerCase();return e?i.items.filter(t=>{const n=t.name.toLowerCase(),a=t.category.toLowerCase();return n.includes(e)||a.includes(e)}):i.items.slice()}function le(){const e=new Map;for(const n of ue()){const a=n.category;e.has(a)||e.set(a,[]),e.get(a).push(n)}return[...e.keys()].sort((n,a)=>E.compare(n,a)).map(n=>{const a=e.get(n).slice().sort((r,s)=>{const o=E.compare(r.name.trim(),s.name.trim());return o!==0?o:E.compare(r.id,s.id)});return{category:n,items:a}})}function D(e,t){const n=ie();e.innerHTML="";for(const r of n){const s=document.createElement("option");s.value=r,s.textContent=r,e.append(s)}const a=document.createElement("option");a.value="__custom__",a.textContent="+ Create new category",e.append(a),t&&[...e.options].some(r=>r.value===t)&&(e.value=t)}function A(){D(g,g.value),D(f,f.value)}function me(e){return W(e)?v(e)?"Running low":"In stock":"Check values"}function U(){const e=i.items.filter(t=>v(t)).length;j.textContent=`${i.items.length} items â€¢ ${e} low`}function O(){const e=le();if(I.innerHTML="",e.length===0){const t=document.createElement("p");t.className="empty-state",t.textContent=_?"No items match your search.":"No items yet. Add your first cupboard item below.",I.append(t),U();return}for(const t of e){const n=document.createElement("section");n.className="category-section";const a=document.createElement("div");a.className="category-header";const r=document.createElement("span");r.textContent=t.category;const s=document.createElement("span");s.className="category-count",s.textContent=`${t.items.length} item${t.items.length===1?"":"s"}`,a.append(r,s);const o=document.createElement("div");o.className="items-list",o.setAttribute("role","list");for(const u of t.items){const c=Y.content.firstElementChild.cloneNode(!0),p=c.querySelector('[data-field="name"]'),h=c.querySelector('[data-field="quantity"]'),b=c.querySelector('[data-field="status"]'),z=c.querySelector('[data-action="edit"]');p.textContent=u.name,h.value=u.quantity,b.textContent=me(u),c.classList.toggle("low",v(u)),W(u)?b.className=v(u)?"item-status status-low":"item-status status-ok":b.className="item-status status-warn",h.addEventListener("change",()=>{u.quantity=h.value.trim(),M(),x()}),z.addEventListener("click",()=>{de(u.id)}),o.append(c)}n.append(a,o),I.append(n)}U()}function d(e,t="ok"){B.textContent=e,B.dataset.tone=t}function P(){const e=g.value==="__custom__";ee.classList.toggle("hidden",!e),k.required=e,e&&k.focus()}function q(e,t="ok"){F.textContent=e,F.dataset.tone=t}function T(){const e=f.value==="__custom__";ne.classList.toggle("hidden",!e),S.required=e,e||(S.value="")}function de(e){const t=i.items.find(n=>n.id===e);t&&(C=e,A(),H.value=t.name,V.value=t.lowLevel,f.value=t.category,S.value="",T(),q("Update details and save."),typeof l.showModal=="function"?l.showModal():l.setAttribute("open",""))}function w(){C=null,typeof l.close=="function"?l.close():l.removeAttribute("open")}function ye(e){if(e.preventDefault(),!C)return;const t=i.items.find(c=>c.id===C);if(!t){w();return}const n=H.value.trim(),a=V.value.trim(),r=f.value,s=S.value.trim(),o=r==="__custom__"?s:r;if(!n||!a||!o){q("Please complete all fields.","error");return}if(m(a)===null){q("Running low level must be a number.","error");return}if(i.items.some(c=>c.id!==t.id&&c.name.toLowerCase()===n.toLowerCase()&&c.category.toLowerCase()===o.toLowerCase())){q("That item already exists in this category.","error");return}t.name=n,t.lowLevel=a,t.category=o,!y.includes(o)&&!i.customCategories.includes(o)&&(i.customCategories.push(o),i.customCategories.sort((c,p)=>c.localeCompare(p))),M(),w(),x(),d(`Updated ${n}.`,"ok")}function ge(e){e.preventDefault();const t=K.value.trim(),n=Z.value.trim(),a=G.value.trim(),r=g.value,s=k.value.trim();let o=r;if(r==="__custom__"&&(o=s),!t||!n||!a||!o){d("Please complete all fields.","error");return}if(m(n)===null||m(a)===null){d("Quantity and low level must be numbers.","error");return}if(i.items.some(c=>c.name.toLowerCase()===t.toLowerCase()&&c.category.toLowerCase()===o.toLowerCase())){d("That item already exists in this category.","error");return}i.items.push({id:N(),name:t,quantity:n,lowLevel:a,category:o}),!y.includes(o)&&!i.customCategories.includes(o)&&(i.customCategories.push(o),i.customCategories.sort((c,p)=>c.localeCompare(p))),M(),A(),O(),Q.reset(),G.value=L,g.value=o,P(),d(`Added ${t}.`,"ok")}function fe(){R.addEventListener("input",()=>{_=R.value,O()}),ae.addEventListener("click",()=>{X.scrollIntoView({behavior:"smooth",block:"start"}),window.setTimeout(()=>{K.focus()},200)}),g.addEventListener("change",P),Q.addEventListener("submit",ge),f.addEventListener("change",T),te.addEventListener("submit",ye),oe.addEventListener("click",w),l.addEventListener("cancel",()=>{C=null}),l.addEventListener("click",e=>{e.target===l&&w()})}function x(){A(),P(),T(),O()}G.value=L;fe();x();d("Ready.");
