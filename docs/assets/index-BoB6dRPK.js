(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const V="cupboard-app-state-v1",se=[{name:"Arribato rice",quantity:"1.25",category:"Grains & Pasta"},{name:"Microwave rice",quantity:"2",category:"Grains & Pasta"},{name:"Couscous",quantity:"2",category:"Grains & Pasta"},{name:"Penne Pasta",quantity:"1",category:"Grains & Pasta"},{name:"Rigatoni",quantity:"0.5",category:"Other"},{name:"Medium egg noodles",quantity:"0.5",category:"Grains & Pasta"},{name:"Risotto truffle kit",quantity:"1",category:"Grains & Pasta"},{name:"Miso paste",quantity:"1",category:"Spices & Seasonings"},{name:"Capsicana hot honey",quantity:"1",category:"Sauces & Condiments"},{name:"Garlic seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"BBQ seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"Lentil vertes",quantity:"1",category:"Legumes & Flours"},{name:"Red lentils",quantity:"1",category:"Legumes & Flours"},{name:"Gram flour",quantity:"1",category:"Legumes & Flours"},{name:"Hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Sweet hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Texas BBQ sauce",quantity:"1.25",category:"Sauces & Condiments"},{name:"Korean hot sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Caramel sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Kewpie",quantity:"1",category:"Sauces & Condiments"},{name:"Peanut butter",quantity:"2",category:"Canned Goods"},{name:"Chilli paste",quantity:"1",category:"Sauces & Condiments"},{name:"Mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Grainy mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Chicken korma paste",quantity:"1",category:"Sauces & Condiments"},{name:"Cuppa soup chicken",quantity:"2",category:"Canned Goods"},{name:"Bread crumbs",quantity:"1",category:"Canned Goods"},{name:"Chickpeas",quantity:"1",category:"Legumes & Flours"},{name:"Red cabbage jar",quantity:"1",category:"Canned Goods"},{name:"Gherkins",quantity:"1",category:"Canned Goods"},{name:"Black beans",quantity:"4",category:"Canned Goods"},{name:"Chopped tomatoes",quantity:"1",category:"Canned Goods"},{name:"Coconut cream",quantity:"2",category:"Canned Goods"},{name:"Peach slices",quantity:"1",category:"Canned Goods"},{name:"Tuna tin",quantity:"1",category:"Canned Goods"},{name:"Baked beans",quantity:"1",category:"Canned Goods"},{name:"Chicken gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Vegan gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Chicken stock",quantity:"1",category:"Stock & Gravy"},{name:"Vegetable stock",quantity:"1",category:"Stock & Gravy"},{name:"Beef stock",quantity:"1",category:"Stock & Gravy"}],_="1",C=["Canned Goods","Grains & Pasta","Legumes & Flours","Sauces & Condiments","Spices & Seasonings","Stock & Gravy","Other"],M=new Intl.Collator(void 0,{sensitivity:"base",numeric:!0}),Q=document.querySelector("#filter-bar"),$=document.querySelector("#search-panel"),T=document.querySelector("#search-toggle-btn"),ce=document.querySelector("#clear-search-btn"),B=document.querySelector("#items-body"),ie=document.querySelector("#row-template"),ue=document.querySelector("#add-section"),j=document.querySelector("#new-item-form"),z=document.querySelector("#form-message"),Y=document.querySelector("#new-name"),le=document.querySelector("#new-quantity"),F=document.querySelector("#new-low-level"),v=document.querySelector("#new-category-select"),de=document.querySelector("#new-custom-category-wrap"),O=document.querySelector("#new-custom-category"),l=document.querySelector("#edit-dialog"),me=document.querySelector("#edit-item-form"),X=document.querySelector("#edit-name"),Z=document.querySelector("#edit-low-level"),q=document.querySelector("#edit-category-select"),ye=document.querySelector("#edit-custom-category-wrap"),I=document.querySelector("#edit-custom-category"),ge=document.querySelector("#cancel-edit"),H=document.querySelector("#edit-message"),f=document.querySelector("#search-input"),fe=document.querySelector("#top-add-button");let c=ve(),L=null,S="",h=!1,d="all";function P(){return globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`}function g(e){if(e==null)return null;const t=String(e).trim().replace(",",".");if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}function K(e){return Number(e.toFixed(3)).toString()}function W(e){return String(e??"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim()}function ee(e){const t=g(e.quantity),n=g(e.lowLevel);return t===null||n===null?!1:t<=n}function pe(){return se.map(e=>({id:P(),name:e.name,quantity:e.quantity,lowLevel:_,category:e.category}))}function Ce(e){const t=new Set(C);for(const n of e)t.add(n.category);return[...t].sort((n,a)=>n.localeCompare(a))}function ve(){const e=pe(),t=Ce(e);try{const n=localStorage.getItem(V);if(!n)return{items:e,customCategories:t.filter(o=>!C.includes(o))};const a=JSON.parse(n),r=Array.isArray(a.items)?a.items.filter(o=>o&&o.name&&o.category).map(o=>({id:o.id||P(),name:String(o.name).trim(),quantity:String(o.quantity??""),lowLevel:String(o.lowLevel??_),category:String(o.category).trim()})):e,s=Array.isArray(a.customCategories)?a.customCategories.map(o=>String(o).trim()).filter(Boolean):[];return{items:r,customCategories:s}}catch{return{items:e,customCategories:t.filter(n=>!C.includes(n))}}}function w(){localStorage.setItem(V,JSON.stringify(c))}function te(){const e=new Set([...C,...c.customCategories]);for(const t of c.items)e.add(t.category);return[...e].sort((t,n)=>t.localeCompare(n))}function qe(){const e=W(S).split(/\s+/).filter(Boolean);return c.items.filter(t=>{const n=d==="all"||d==="low"&&ee(t)||t.category===d;if(e.length===0)return n;const a=W(`${t.name} ${t.category}`);return e.every(r=>a.includes(r))})}function Se(){const e=new Map;for(const n of qe()){const a=n.category;e.has(a)||e.set(a,[]),e.get(a).push(n)}return[...e.keys()].sort((n,a)=>M.compare(n,a)).map(n=>{const a=e.get(n).slice().sort((r,s)=>{const o=M.compare(r.name.trim(),s.name.trim());return o!==0?o:M.compare(r.id,s.id)});return{category:n,items:a}})}function J(e,t){const n=te();e.innerHTML="";for(const r of n){const s=document.createElement("option");s.value=r,s.textContent=r,e.append(s)}const a=document.createElement("option");a.value="__custom__",a.textContent="+ Create new category",e.append(a),t&&[...e.options].some(r=>r.value===t)&&(e.value=t)}function ne(){J(v,v.value),J(q,q.value)}function he(){const e=[{value:"all",label:"All"},{value:"low",label:"Low"},...te().map(t=>({value:t,label:t}))];e.some(t=>t.value===d)||(d="all"),Q.innerHTML="";for(const t of e){const n=document.createElement("button");n.type="button",n.className=`filter-chip${d===t.value?" active":""}`,n.setAttribute("role","radio"),n.setAttribute("aria-checked",d===t.value?"true":"false"),n.dataset.filter=t.value;const a=document.createElement("span");a.textContent=t.label,n.append(a),n.addEventListener("click",()=>{d=t.value,y()}),Q.append(n)}}function x(){const e=Se();if(B.innerHTML="",e.length===0){const t=document.createElement("p");t.className="empty-state",t.textContent=S?"No items match your search.":"No items yet. Add your first cupboard item below.",B.append(t);return}for(const t of e){const n=document.createElement("section");n.className="category-section";const a=document.createElement("div");a.className="category-header";const r=document.createElement("span");r.textContent=t.category,a.append(r);const s=document.createElement("div");s.className="items-list",s.setAttribute("role","list");for(const o of t.items){const u=ie.content.firstElementChild.cloneNode(!0),i=u.querySelector('[data-field="name"]'),m=u.querySelector('[data-field="quantity"]'),oe=u.querySelector('[data-action="decrease"]'),ae=u.querySelector('[data-action="increase"]'),re=u.querySelector('[data-action="edit"]');i.textContent=o.name,m.value=o.quantity,u.classList.toggle("low",ee(o)),m.addEventListener("change",()=>{o.quantity=m.value.trim(),w(),y()}),oe.addEventListener("click",()=>{const U=g(o.quantity)??0,A=Math.max(0,U-1);o.quantity=K(A),w(),y()}),ae.addEventListener("click",()=>{const A=(g(o.quantity)??0)+1;o.quantity=K(A),w(),y()}),re.addEventListener("click",()=>{we(o.id)}),s.append(u)}n.append(a,s),B.append(n)}}function p(e,t="ok"){z.textContent=e,z.dataset.tone=t}function N(){const e=S.trim().length>0;$.classList.toggle("open",h),$.classList.toggle("has-query",e),T.classList.toggle("active",h||e),T.setAttribute("aria-expanded",h?"true":"false")}function b(e,t={}){h=e,N(),e&&t.focus&&window.setTimeout(()=>{f.focus()},120)}function E(){S="",f.value="",x(),N()}function D(){const e=v.value==="__custom__";de.classList.toggle("hidden",!e),O.required=e,e&&O.focus()}function k(e,t="ok"){H.textContent=e,H.dataset.tone=t}function R(){const e=q.value==="__custom__";ye.classList.toggle("hidden",!e),I.required=e,e||(I.value="")}function we(e){const t=c.items.find(n=>n.id===e);t&&(L=e,ne(),X.value=t.name,Z.value=t.lowLevel,q.value=t.category,I.value="",R(),k("Update details and save."),typeof l.showModal=="function"?l.showModal():l.setAttribute("open",""))}function G(){L=null,typeof l.close=="function"?l.close():l.removeAttribute("open")}function Le(e){if(e.preventDefault(),!L)return;const t=c.items.find(i=>i.id===L);if(!t){G();return}const n=X.value.trim(),a=Z.value.trim(),r=q.value,s=I.value.trim(),o=r==="__custom__"?s:r;if(!n||!a||!o){k("Please complete all fields.","error");return}if(g(a)===null){k("Running low level must be a number.","error");return}if(c.items.some(i=>i.id!==t.id&&i.name.toLowerCase()===n.toLowerCase()&&i.category.toLowerCase()===o.toLowerCase())){k("That item already exists in this category.","error");return}t.name=n,t.lowLevel=a,t.category=o,!C.includes(o)&&!c.customCategories.includes(o)&&(c.customCategories.push(o),c.customCategories.sort((i,m)=>i.localeCompare(m))),w(),G(),y(),p(`Updated ${n}.`,"ok")}function be(e){e.preventDefault();const t=Y.value.trim(),n=le.value.trim(),a=F.value.trim(),r=v.value,s=O.value.trim();let o=r;if(r==="__custom__"&&(o=s),!t||!n||!a||!o){p("Please complete all fields.","error");return}if(g(n)===null||g(a)===null){p("Quantity and low level must be numbers.","error");return}if(c.items.some(i=>i.name.toLowerCase()===t.toLowerCase()&&i.category.toLowerCase()===o.toLowerCase())){p("That item already exists in this category.","error");return}c.items.push({id:P(),name:t,quantity:n,lowLevel:a,category:o}),!C.includes(o)&&!c.customCategories.includes(o)&&(c.customCategories.push(o),c.customCategories.sort((i,m)=>i.localeCompare(m))),w(),y(),j.reset(),F.value=_,v.value=o,D(),p(`Added ${t}.`,"ok")}function Ee(){f.addEventListener("input",()=>{S=f.value,x(),N()}),f.addEventListener("keydown",e=>{if(e.key==="Escape"){if(S.trim()){E();return}b(!1)}}),T.addEventListener("click",()=>{if(h){E(),b(!1);return}b(!0,{focus:!0})}),ce.addEventListener("click",()=>{E(),f.focus()}),fe.addEventListener("click",()=>{E(),b(!1),ue.scrollIntoView({behavior:"smooth",block:"start"}),window.setTimeout(()=>{Y.focus()},200)}),v.addEventListener("change",D),j.addEventListener("submit",be),q.addEventListener("change",R),me.addEventListener("submit",Le),ge.addEventListener("click",G),l.addEventListener("cancel",()=>{L=null}),l.addEventListener("click",e=>{e.target===l&&G()})}function y(){ne(),he(),D(),R(),x(),N()}F.value=_;Ee();y();p("Ready.");
