(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(a){if(a.ep)return;a.ep=!0;const s=n(a);fetch(a.href,s)}})();const D="cupboard-app-state-v1",J=[{name:"Arribato rice",quantity:"1.25",category:"Grains & Pasta"},{name:"Microwave rice",quantity:"2",category:"Grains & Pasta"},{name:"Couscous",quantity:"2",category:"Grains & Pasta"},{name:"Penne Pasta",quantity:"1",category:"Grains & Pasta"},{name:"Rigatoni",quantity:"0.5",category:"Other"},{name:"Medium egg noodles",quantity:"0.5",category:"Grains & Pasta"},{name:"Risotto truffle kit",quantity:"1",category:"Grains & Pasta"},{name:"Miso paste",quantity:"1",category:"Spices & Seasonings"},{name:"Capsicana hot honey",quantity:"1",category:"Sauces & Condiments"},{name:"Garlic seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"BBQ seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"Lentil vertes",quantity:"1",category:"Legumes & Flours"},{name:"Red lentils",quantity:"1",category:"Legumes & Flours"},{name:"Gram flour",quantity:"1",category:"Legumes & Flours"},{name:"Hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Sweet hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Texas BBQ sauce",quantity:"1.25",category:"Sauces & Condiments"},{name:"Korean hot sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Caramel sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Kewpie",quantity:"1",category:"Sauces & Condiments"},{name:"Peanut butter",quantity:"2",category:"Canned Goods"},{name:"Chilli paste",quantity:"1",category:"Sauces & Condiments"},{name:"Mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Grainy mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Chicken korma paste",quantity:"1",category:"Sauces & Condiments"},{name:"Cuppa soup chicken",quantity:"2",category:"Canned Goods"},{name:"Bread crumbs",quantity:"1",category:"Canned Goods"},{name:"Chickpeas",quantity:"1",category:"Legumes & Flours"},{name:"Red cabbage jar",quantity:"1",category:"Canned Goods"},{name:"Gherkins",quantity:"1",category:"Canned Goods"},{name:"Black beans",quantity:"4",category:"Canned Goods"},{name:"Chopped tomatoes",quantity:"1",category:"Canned Goods"},{name:"Coconut cream",quantity:"2",category:"Canned Goods"},{name:"Peach slices",quantity:"1",category:"Canned Goods"},{name:"Tuna tin",quantity:"1",category:"Canned Goods"},{name:"Baked beans",quantity:"1",category:"Canned Goods"},{name:"Chicken gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Vegan gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Chicken stock",quantity:"1",category:"Stock & Gravy"},{name:"Vegetable stock",quantity:"1",category:"Stock & Gravy"},{name:"Beef stock",quantity:"1",category:"Stock & Gravy"}],I="1",g=["Canned Goods","Grains & Pasta","Legumes & Flours","Sauces & Condiments","Spices & Seasonings","Stock & Gravy","Other"],k=new Intl.Collator(void 0,{sensitivity:"base",numeric:!0}),V=document.querySelector("#summary"),_=document.querySelector("#items-body"),j=document.querySelector("#row-template"),U=document.querySelector("#new-item-form"),O=document.querySelector("#form-message"),Y=document.querySelector("#new-name"),X=document.querySelector("#new-quantity"),T=document.querySelector("#new-low-level"),f=document.querySelector("#new-category-select"),Z=document.querySelector("#new-custom-category-wrap"),x=document.querySelector("#new-custom-category"),u=document.querySelector("#edit-dialog"),ee=document.querySelector("#edit-item-form"),$=document.querySelector("#edit-name"),K=document.querySelector("#edit-low-level"),C=document.querySelector("#edit-category-select"),te=document.querySelector("#edit-custom-category-wrap"),w=document.querySelector("#edit-custom-category"),ne=document.querySelector("#cancel-edit"),R=document.querySelector("#edit-message"),L=document.querySelector("#undo-toast"),oe=document.querySelector("#undo-text"),ae=document.querySelector("#undo-button");let i=ie(),p=null,l=null;function M(){return globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`}function y(e){if(e==null)return null;const t=String(e).trim().replace(",",".");if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}function h(e){const t=y(e.quantity),n=y(e.lowLevel);return t===null||n===null?!1:t<=n}function Q(e){return y(e.quantity)!==null&&y(e.lowLevel)!==null}function re(){return J.map(e=>({id:M(),name:e.name,quantity:e.quantity,lowLevel:I,category:e.category}))}function se(e){const t=new Set(g);for(const n of e)t.add(n.category);return[...t].sort((n,r)=>n.localeCompare(r))}function ie(){const e=re(),t=se(e);try{const n=localStorage.getItem(D);if(!n)return{items:e,customCategories:t.filter(o=>!g.includes(o))};const r=JSON.parse(n),a=Array.isArray(r.items)?r.items.filter(o=>o&&o.name&&o.category).map(o=>({id:o.id||M(),name:String(o.name).trim(),quantity:String(o.quantity??""),lowLevel:String(o.lowLevel??I),category:String(o.category).trim()})):e,s=Array.isArray(r.customCategories)?r.customCategories.map(o=>String(o).trim()).filter(Boolean):[];return{items:a,customCategories:s}}catch{return{items:e,customCategories:t.filter(n=>!g.includes(n))}}}function q(){localStorage.setItem(D,JSON.stringify(i))}function ce(){const e=new Set([...g,...i.customCategories]);for(const t of i.items)e.add(t.category);return[...e].sort((t,n)=>t.localeCompare(n))}function ue(){let e=i.items.slice();return e.sort((t,n)=>{const r=k.compare(t.name.trim(),n.name.trim());if(r!==0)return r;const a=k.compare(t.category.trim(),n.category.trim());return a!==0?a:k.compare(t.id,n.id)}),e}function B(e,t){const n=ce();e.innerHTML="";for(const a of n){const s=document.createElement("option");s.value=a,s.textContent=a,e.append(s)}const r=document.createElement("option");r.value="__custom__",r.textContent="+ Create new category",e.append(r),t&&[...e.options].some(a=>a.value===t)&&(e.value=t)}function N(){B(f,f.value),B(C,C.value)}function le(e){return Q(e)?h(e)?"Running low":"In stock":"Check values"}function F(){const e=i.items.filter(t=>h(t)).length;V.textContent=`${i.items.length} items â€¢ ${e} low`}function H(){const e=ue();if(_.innerHTML="",e.length===0){const t=document.createElement("p");t.className="empty-state",t.textContent="No items yet. Add your first cupboard item above.",_.append(t),F();return}for(const t of e){const n=j.content.firstElementChild.cloneNode(!0),r=n.querySelector('[data-field="name"]'),a=n.querySelector('[data-field="category"]'),s=n.querySelector('[data-field="quantity"]'),o=n.querySelector('[data-field="status"]'),G=n.querySelector('[data-action="edit"]'),c=n.querySelector('[data-action="delete"]');r.textContent=t.name,a.textContent=t.category,s.value=t.quantity,o.textContent=le(t),n.classList.toggle("low",h(t)),Q(t)?o.className=h(t)?"item-status status-low":"item-status status-ok":o.className="item-status status-warn",s.addEventListener("change",()=>{t.quantity=s.value.trim(),q(),S()}),G.addEventListener("click",()=>{ge(t.id)}),c.addEventListener("click",()=>{const m=i.items.findIndex(z=>z.id===t.id);if(m===-1)return;const[W]=i.items.splice(m,1);q(),S(),de(W,m)}),_.append(n)}F()}function d(e,t="ok"){O.textContent=e,O.dataset.tone=t}function E(){L.classList.remove("show"),L.setAttribute("aria-hidden","true")}function me(){l&&(window.clearTimeout(l.timerId),l=null,E())}function de(e,t){me(),oe.textContent=`Removed ${e.name}.`,L.classList.add("show"),L.setAttribute("aria-hidden","false");const n=window.setTimeout(()=>{l=null,E()},5e3);l={item:e,index:t,timerId:n}}function ye(){if(!l)return;const{item:e,index:t,timerId:n}=l;window.clearTimeout(n),l=null;const r=Math.max(0,Math.min(t,i.items.length));i.items.splice(r,0,e),q(),E(),S(),d(`Restored ${e.name}.`,"ok")}function A(){const e=f.value==="__custom__";Z.classList.toggle("hidden",!e),x.required=e,e&&x.focus()}function v(e,t="ok"){R.textContent=e,R.dataset.tone=t}function P(){const e=C.value==="__custom__";te.classList.toggle("hidden",!e),w.required=e,e||(w.value="")}function ge(e){const t=i.items.find(n=>n.id===e);t&&(p=e,N(),$.value=t.name,K.value=t.lowLevel,C.value=t.category,w.value="",P(),v("Update details and save."),typeof u.showModal=="function"?u.showModal():u.setAttribute("open",""))}function b(){p=null,typeof u.close=="function"?u.close():u.removeAttribute("open")}function fe(e){if(e.preventDefault(),!p)return;const t=i.items.find(c=>c.id===p);if(!t){b();return}const n=$.value.trim(),r=K.value.trim(),a=C.value,s=w.value.trim(),o=a==="__custom__"?s:a;if(!n||!r||!o){v("Please complete all fields.","error");return}if(y(r)===null){v("Running low level must be a number.","error");return}if(i.items.some(c=>c.id!==t.id&&c.name.toLowerCase()===n.toLowerCase()&&c.category.toLowerCase()===o.toLowerCase())){v("That item already exists in this category.","error");return}t.name=n,t.lowLevel=r,t.category=o,!g.includes(o)&&!i.customCategories.includes(o)&&(i.customCategories.push(o),i.customCategories.sort((c,m)=>c.localeCompare(m))),q(),b(),S(),d(`Updated ${n}.`,"ok")}function Ce(e){e.preventDefault();const t=Y.value.trim(),n=X.value.trim(),r=T.value.trim(),a=f.value,s=x.value.trim();let o=a;if(a==="__custom__"&&(o=s),!t||!n||!r||!o){d("Please complete all fields.","error");return}if(y(n)===null||y(r)===null){d("Quantity and low level must be numbers.","error");return}if(i.items.some(c=>c.name.toLowerCase()===t.toLowerCase()&&c.category.toLowerCase()===o.toLowerCase())){d("That item already exists in this category.","error");return}i.items.push({id:M(),name:t,quantity:n,lowLevel:r,category:o}),!g.includes(o)&&!i.customCategories.includes(o)&&(i.customCategories.push(o),i.customCategories.sort((c,m)=>c.localeCompare(m))),q(),N(),H(),U.reset(),T.value=I,f.value=o,A(),d(`Added ${t}.`,"ok")}function pe(){f.addEventListener("change",A),U.addEventListener("submit",Ce),C.addEventListener("change",P),ee.addEventListener("submit",fe),ne.addEventListener("click",b),ae.addEventListener("click",ye),u.addEventListener("cancel",()=>{p=null}),u.addEventListener("click",e=>{e.target===u&&b()})}function S(){N(),A(),P(),H()}T.value=I;pe();S();E();d("Ready.");
