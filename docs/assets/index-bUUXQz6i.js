(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&a(r)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();const X="cupboard-app-state-v1",ye=[{name:"Arribato rice",quantity:"1.25",category:"Grains & Pasta"},{name:"Microwave rice",quantity:"2",category:"Grains & Pasta"},{name:"Couscous",quantity:"2",category:"Grains & Pasta"},{name:"Penne Pasta",quantity:"1",category:"Grains & Pasta"},{name:"Rigatoni",quantity:"0.5",category:"Other"},{name:"Medium egg noodles",quantity:"0.5",category:"Grains & Pasta"},{name:"Risotto truffle kit",quantity:"1",category:"Grains & Pasta"},{name:"Miso paste",quantity:"1",category:"Spices & Seasonings"},{name:"Capsicana hot honey",quantity:"1",category:"Sauces & Condiments"},{name:"Garlic seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"BBQ seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"Lentil vertes",quantity:"1",category:"Legumes & Flours"},{name:"Red lentils",quantity:"1",category:"Legumes & Flours"},{name:"Gram flour",quantity:"1",category:"Legumes & Flours"},{name:"Hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Sweet hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Texas BBQ sauce",quantity:"1.25",category:"Sauces & Condiments"},{name:"Korean hot sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Caramel sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Kewpie",quantity:"1",category:"Sauces & Condiments"},{name:"Peanut butter",quantity:"2",category:"Canned Goods"},{name:"Chilli paste",quantity:"1",category:"Sauces & Condiments"},{name:"Mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Grainy mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Chicken korma paste",quantity:"1",category:"Sauces & Condiments"},{name:"Cuppa soup chicken",quantity:"2",category:"Canned Goods"},{name:"Bread crumbs",quantity:"1",category:"Canned Goods"},{name:"Chickpeas",quantity:"1",category:"Legumes & Flours"},{name:"Red cabbage jar",quantity:"1",category:"Canned Goods"},{name:"Gherkins",quantity:"1",category:"Canned Goods"},{name:"Black beans",quantity:"4",category:"Canned Goods"},{name:"Chopped tomatoes",quantity:"1",category:"Canned Goods"},{name:"Coconut cream",quantity:"2",category:"Canned Goods"},{name:"Peach slices",quantity:"1",category:"Canned Goods"},{name:"Tuna tin",quantity:"1",category:"Canned Goods"},{name:"Baked beans",quantity:"1",category:"Canned Goods"},{name:"Chicken gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Vegan gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Chicken stock",quantity:"1",category:"Stock & Gravy"},{name:"Vegetable stock",quantity:"1",category:"Stock & Gravy"},{name:"Beef stock",quantity:"1",category:"Stock & Gravy"}],Z="1",ee="0",p=["Canned Goods","Grains & Pasta","Legumes & Flours","Sauces & Condiments","Spices & Seasonings","Stock & Gravy","Other"],M=new Intl.Collator(void 0,{sensitivity:"base",numeric:!0}),z=document.querySelector("#filter-bar"),W=document.querySelector("#search-panel"),A=document.querySelector("#search-toggle-btn"),ge=document.querySelector("#clear-search-btn"),x=document.querySelector("#items-body"),fe=document.querySelector("#row-template"),pe=document.querySelector("#add-section"),te=document.querySelector("#new-item-form"),H=document.querySelector("#form-message"),ne=document.querySelector("#new-name"),Ce=document.querySelector("#new-quantity"),F=document.querySelector("#new-low-level"),q=document.querySelector("#new-category-select"),ve=document.querySelector("#new-custom-category-wrap"),O=document.querySelector("#new-custom-category"),d=document.querySelector("#edit-dialog"),Se=document.querySelector("#edit-item-form"),oe=document.querySelector("#edit-name"),ae=document.querySelector("#edit-low-level"),L=document.querySelector("#edit-category-select"),qe=document.querySelector("#edit-custom-category-wrap"),T=document.querySelector("#edit-custom-category"),Le=document.querySelector("#delete-item-button"),he=document.querySelector("#cancel-edit"),K=document.querySelector("#edit-message"),re=document.querySelector("#undo-toast"),we=document.querySelector("#undo-toast-message"),be=document.querySelector("#undo-delete-button"),S=document.querySelector("#search-input"),Ee=document.querySelector("#top-add-button"),V=document.querySelector("#cloud-status-badge"),se=document.querySelector("#cloud-sync-now-button");let c=Te(),C=null,h="",b=!1,y="all",_=null,k=null;function D(){return globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`}function v(e){if(e==null)return null;const t=String(e).trim().replace(",",".");if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}function J(e){return Number(e.toFixed(3)).toString()}function j(e){return String(e??"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().trim()}function ce(e){const t=v(e.quantity),n=v(e.lowLevel);return t===null||n===null?!1:t<=n}function Ie(){return ye.map(e=>({id:D(),name:e.name,quantity:e.quantity,lowLevel:Z,category:e.category}))}function ke(e){const t=new Set(p);for(const n of e)t.add(n.category);return[...t].sort((n,a)=>n.localeCompare(a))}function Ge(e,t){const n=Array.isArray(e?.items)?e.items.filter(o=>o&&o.name&&o.category).map(o=>({id:o.id||D(),name:String(o.name).trim(),quantity:String(o.quantity??""),lowLevel:String(o.lowLevel??Z),category:String(o.category).trim()})):t,a=Array.isArray(e?.customCategories)?e.customCategories.map(o=>String(o).trim()).filter(Boolean):[];return{items:n,customCategories:a}}function Te(){const e=Ie(),t=ke(e);try{const n=localStorage.getItem(X);if(!n)return{items:e,customCategories:t.filter(o=>!p.includes(o))};const a=JSON.parse(n);return Ge(a,e)}catch{return{items:e,customCategories:t.filter(n=>!p.includes(n))}}}function _e(){localStorage.setItem(X,JSON.stringify(c))}function f(){_e()}function ie(){const e=new Set([...p,...c.customCategories]);for(const t of c.items)e.add(t.category);return[...e].sort((t,n)=>t.localeCompare(n))}function Ne(){const e=j(h).split(/\s+/).filter(Boolean);return c.items.filter(t=>{const n=y==="all"||y==="low"&&ce(t)||t.category===y;if(e.length===0)return n;const a=j(`${t.name} ${t.category}`);return e.every(o=>a.includes(o))})}function Be(){const e=new Map;for(const n of Ne()){const a=n.category;e.has(a)||e.set(a,[]),e.get(a).push(n)}return[...e.keys()].sort((n,a)=>M.compare(n,a)).map(n=>{const a=e.get(n).slice().sort((o,s)=>{const r=M.compare(o.name.trim(),s.name.trim());return r!==0?r:M.compare(o.id,s.id)});return{category:n,items:a}})}function Y(e,t){const n=ie();e.innerHTML="";for(const o of n){const s=document.createElement("option");s.value=o,s.textContent=o,e.append(s)}const a=document.createElement("option");a.value="__custom__",a.textContent="+ Create new category",e.append(a),t&&[...e.options].some(o=>o.value===t)&&(e.value=t)}function ue(){Y(q,q.value),Y(L,L.value)}function Me(){const e=[{value:"all",label:"All"},{value:"low",label:"Low"},...ie().map(t=>({value:t,label:t}))];e.some(t=>t.value===y)||(y="all"),z.innerHTML="";for(const t of e){const n=document.createElement("button");n.type="button",n.className=`filter-chip${y===t.value?" active":""}`,n.setAttribute("role","radio"),n.setAttribute("aria-checked",y===t.value?"true":"false"),n.dataset.filter=t.value;const a=document.createElement("span");a.textContent=t.label,n.append(a),n.addEventListener("click",()=>{y=t.value,m()}),z.append(n)}}function R(){const e=Be();if(x.innerHTML="",e.length===0){const t=document.createElement("p");t.className="empty-state",t.textContent=h?"No items match your search.":"No items yet. Add your first cupboard item below.",x.append(t);return}for(const t of e){const n=document.createElement("section");n.className="category-section";const a=document.createElement("div");a.className="category-header";const o=document.createElement("span");o.textContent=t.category,a.append(o);const s=document.createElement("div");s.className="items-list",s.setAttribute("role","list");for(const r of t.items){const u=fe.content.firstElementChild.cloneNode(!0),i=u.querySelector('[data-field="name"]'),g=u.querySelector('[data-field="quantity"]'),le=u.querySelector('[data-action="decrease"]'),de=u.querySelector('[data-action="increase"]'),me=u.querySelector('[data-action="edit"]');i.textContent=r.name,g.value=r.quantity,u.classList.toggle("low",ce(r)),g.addEventListener("change",()=>{r.quantity=g.value.trim(),f(),m()}),le.addEventListener("click",()=>{const Q=v(r.quantity)??0,B=Math.max(0,Q-1);r.quantity=J(B),f(),m()}),de.addEventListener("click",()=>{const B=(v(r.quantity)??0)+1;r.quantity=J(B),f(),m()}),me.addEventListener("click",()=>{Ue(r.id)}),s.append(u)}n.append(a,s),x.append(n)}}function l(e,t="ok"){H.textContent=e,H.dataset.tone=t}function xe(e,t){V.classList.remove("syncing","synced","error"),V.textContent=t}function Ae(){{xe("","Local only"),se.disabled=!0;return}}async function Fe(){}async function Oe(){Ae();{l("Ready. Local-only mode (cloud not configured).","ok");return}}function Pe(){k!==null&&(window.clearTimeout(k),k=null)}function P(e=!0){Pe(),re.classList.remove("open"),e&&(_=null)}function De(e,t){P(!1),_={item:e,index:t},we.textContent=`Removed ${e.name}.`,re.classList.add("open"),k=window.setTimeout(()=>{P(!0)},3e3)}function Re(){if(!_)return;const{item:e,index:t}=_,n=Math.max(0,Math.min(t,c.items.length));c.items.splice(n,0,e),!p.includes(e.category)&&!c.customCategories.includes(e.category)&&(c.customCategories.push(e.category),c.customCategories.sort((a,o)=>a.localeCompare(o))),f(),P(!0),m(),l(`Restored ${e.name}.`,"ok")}function N(){const e=h.trim().length>0;W.classList.toggle("open",b),W.classList.toggle("has-query",e),A.classList.toggle("active",b||e),A.setAttribute("aria-expanded",b?"true":"false")}function E(e,t={}){b=e,N(),e&&t.focus&&window.setTimeout(()=>{S.focus()},120)}function I(){h="",S.value="",R(),N()}function U(){const e=q.value==="__custom__";ve.classList.toggle("hidden",!e),O.required=e,e&&O.focus()}function G(e,t="ok"){K.textContent=e,K.dataset.tone=t}function $(){const e=L.value==="__custom__";qe.classList.toggle("hidden",!e),T.required=e,e||(T.value="")}function Ue(e){const t=c.items.find(n=>n.id===e);t&&(C=e,ue(),oe.value=t.name,ae.value=t.lowLevel,L.value=t.category,T.value="",$(),G("Update details and save."),typeof d.showModal=="function"?d.showModal():d.setAttribute("open",""))}function w(){C=null,typeof d.close=="function"?d.close():d.removeAttribute("open")}function $e(e){if(e.preventDefault(),!C)return;const t=c.items.find(i=>i.id===C);if(!t){w();return}const n=oe.value.trim(),a=ae.value.trim(),o=L.value,s=T.value.trim(),r=o==="__custom__"?s:o;if(!n||!a||!r){G("Please complete all fields.","error");return}if(v(a)===null){G("Running low level must be a number.","error");return}if(c.items.some(i=>i.id!==t.id&&i.name.toLowerCase()===n.toLowerCase()&&i.category.toLowerCase()===r.toLowerCase())){G("That item already exists in this category.","error");return}t.name=n,t.lowLevel=a,t.category=r,!p.includes(r)&&!c.customCategories.includes(r)&&(c.customCategories.push(r),c.customCategories.sort((i,g)=>i.localeCompare(g))),f(),w(),m(),l(`Updated ${n}.`,"ok")}function Qe(){if(!C)return;const e=c.items.findIndex(n=>n.id===C);if(e<0){w();return}const[t]=c.items.splice(e,1);f(),w(),m(),De(t,e),l(`Removed ${t.name}.`,"ok")}function ze(e){e.preventDefault();const t=ne.value.trim(),n=Ce.value.trim(),a=F.value.trim(),o=q.value,s=O.value.trim();let r=o;if(o==="__custom__"&&(r=s),!t||!n||!a||!r){l("Please complete all fields.","error");return}if(v(n)===null||v(a)===null){l("Quantity and low level must be numbers.","error");return}if(c.items.some(i=>i.name.toLowerCase()===t.toLowerCase()&&i.category.toLowerCase()===r.toLowerCase())){l("That item already exists in this category.","error");return}c.items.push({id:D(),name:t,quantity:n,lowLevel:a,category:r}),!p.includes(r)&&!c.customCategories.includes(r)&&(c.customCategories.push(r),c.customCategories.sort((i,g)=>i.localeCompare(g))),f(),m(),te.reset(),F.value=ee,q.value=r,U(),l(`Added ${t}.`,"ok")}function We(){S.addEventListener("input",()=>{h=S.value,R(),N()}),S.addEventListener("keydown",e=>{if(e.key==="Escape"){if(h.trim()){I();return}E(!1)}}),A.addEventListener("click",()=>{if(b){I(),E(!1);return}E(!0,{focus:!0})}),ge.addEventListener("click",()=>{I(),S.focus()}),Ee.addEventListener("click",()=>{I(),E(!1),pe.scrollIntoView({behavior:"smooth",block:"start"}),window.setTimeout(()=>{ne.focus()},200)}),se.addEventListener("click",()=>{Fe()}),q.addEventListener("change",U),te.addEventListener("submit",ze),L.addEventListener("change",$),Le.addEventListener("click",Qe),Se.addEventListener("submit",$e),he.addEventListener("click",w),be.addEventListener("click",Re),d.addEventListener("cancel",()=>{C=null}),d.addEventListener("click",e=>{e.target===d&&w()})}function m(){ue(),Me(),U(),$(),R(),N()}F.value=ee;We();m();l("Ready.");Oe();
