(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();const U="cupboard-app-state-v1",Z=[{name:"Arribato rice",quantity:"1.25",category:"Grains & Pasta"},{name:"Microwave rice",quantity:"2",category:"Grains & Pasta"},{name:"Couscous",quantity:"2",category:"Grains & Pasta"},{name:"Penne Pasta",quantity:"1",category:"Grains & Pasta"},{name:"Rigatoni",quantity:"0.5",category:"Other"},{name:"Medium egg noodles",quantity:"0.5",category:"Grains & Pasta"},{name:"Risotto truffle kit",quantity:"1",category:"Grains & Pasta"},{name:"Miso paste",quantity:"1",category:"Spices & Seasonings"},{name:"Capsicana hot honey",quantity:"1",category:"Sauces & Condiments"},{name:"Garlic seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"BBQ seasoning bag",quantity:"1",category:"Spices & Seasonings"},{name:"Lentil vertes",quantity:"1",category:"Legumes & Flours"},{name:"Red lentils",quantity:"1",category:"Legumes & Flours"},{name:"Gram flour",quantity:"1",category:"Legumes & Flours"},{name:"Hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Sweet hoisin sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Texas BBQ sauce",quantity:"1.25",category:"Sauces & Condiments"},{name:"Korean hot sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Caramel sauce",quantity:"1",category:"Sauces & Condiments"},{name:"Kewpie",quantity:"1",category:"Sauces & Condiments"},{name:"Peanut butter",quantity:"2",category:"Canned Goods"},{name:"Chilli paste",quantity:"1",category:"Sauces & Condiments"},{name:"Mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Grainy mustard",quantity:"1",category:"Sauces & Condiments"},{name:"Chicken korma paste",quantity:"1",category:"Sauces & Condiments"},{name:"Cuppa soup chicken",quantity:"2",category:"Canned Goods"},{name:"Bread crumbs",quantity:"1",category:"Canned Goods"},{name:"Chickpeas",quantity:"1",category:"Legumes & Flours"},{name:"Red cabbage jar",quantity:"1",category:"Canned Goods"},{name:"Gherkins",quantity:"1",category:"Canned Goods"},{name:"Black beans",quantity:"4",category:"Canned Goods"},{name:"Chopped tomatoes",quantity:"1",category:"Canned Goods"},{name:"Coconut cream",quantity:"2",category:"Canned Goods"},{name:"Peach slices",quantity:"1",category:"Canned Goods"},{name:"Tuna tin",quantity:"1",category:"Canned Goods"},{name:"Baked beans",quantity:"1",category:"Canned Goods"},{name:"Chicken gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Vegan gravy granules",quantity:"1",category:"Stock & Gravy"},{name:"Chicken stock",quantity:"1",category:"Stock & Gravy"},{name:"Vegetable stock",quantity:"1",category:"Stock & Gravy"},{name:"Beef stock",quantity:"1",category:"Stock & Gravy"}],b="1",p=["Canned Goods","Grains & Pasta","Legumes & Flours","Sauces & Condiments","Spices & Seasonings","Stock & Gravy","Other"],I=new Intl.Collator(void 0,{sensitivity:"base",numeric:!0}),O=document.querySelector("#filter-bar"),G=document.querySelector("#items-body"),ee=document.querySelector("#row-template"),te=document.querySelector("#add-section"),Q=document.querySelector("#new-item-form"),P=document.querySelector("#form-message"),$=document.querySelector("#new-name"),ne=document.querySelector("#new-quantity"),k=document.querySelector("#new-low-level"),C=document.querySelector("#new-category-select"),oe=document.querySelector("#new-custom-category-wrap"),_=document.querySelector("#new-custom-category"),l=document.querySelector("#edit-dialog"),ae=document.querySelector("#edit-item-form"),H=document.querySelector("#edit-name"),K=document.querySelector("#edit-low-level"),q=document.querySelector("#edit-category-select"),re=document.querySelector("#edit-custom-category-wrap"),L=document.querySelector("#edit-custom-category"),se=document.querySelector("#cancel-edit"),T=document.querySelector("#edit-message"),x=document.querySelector("#search-input"),ce=document.querySelector("#fab-add-button");let c=le(),S=null,N="",d="all";function M(){return globalThis.crypto?.randomUUID?globalThis.crypto.randomUUID():`${Date.now()}-${Math.random().toString(16).slice(2)}`}function g(t){if(t==null)return null;const e=String(t).trim().replace(",",".");if(!e)return null;const n=Number(e);return Number.isFinite(n)?n:null}function D(t){return Number(t.toFixed(3)).toString()}function W(t){const e=g(t.quantity),n=g(t.lowLevel);return e===null||n===null?!1:e<=n}function ie(){return Z.map(t=>({id:M(),name:t.name,quantity:t.quantity,lowLevel:b,category:t.category}))}function ue(t){const e=new Set(p);for(const n of t)e.add(n.category);return[...e].sort((n,a)=>n.localeCompare(a))}function le(){const t=ie(),e=ue(t);try{const n=localStorage.getItem(U);if(!n)return{items:t,customCategories:e.filter(o=>!p.includes(o))};const a=JSON.parse(n),r=Array.isArray(a.items)?a.items.filter(o=>o&&o.name&&o.category).map(o=>({id:o.id||M(),name:String(o.name).trim(),quantity:String(o.quantity??""),lowLevel:String(o.lowLevel??b),category:String(o.category).trim()})):t,s=Array.isArray(a.customCategories)?a.customCategories.map(o=>String(o).trim()).filter(Boolean):[];return{items:r,customCategories:s}}catch{return{items:t,customCategories:e.filter(n=>!p.includes(n))}}}function v(){localStorage.setItem(U,JSON.stringify(c))}function z(){const t=new Set([...p,...c.customCategories]);for(const e of c.items)t.add(e.category);return[...t].sort((e,n)=>e.localeCompare(n))}function de(){const t=N.trim().toLowerCase();return c.items.filter(e=>{if(!(d==="all"||d==="low"&&W(e)||e.category===d))return!1;if(!t)return!0;const a=e.name.toLowerCase(),r=e.category.toLowerCase();return a.includes(t)||r.includes(t)})}function me(){const t=new Map;for(const n of de()){const a=n.category;t.has(a)||t.set(a,[]),t.get(a).push(n)}return[...t.keys()].sort((n,a)=>I.compare(n,a)).map(n=>{const a=t.get(n).slice().sort((r,s)=>{const o=I.compare(r.name.trim(),s.name.trim());return o!==0?o:I.compare(r.id,s.id)});return{category:n,items:a}})}function R(t,e){const n=z();t.innerHTML="";for(const r of n){const s=document.createElement("option");s.value=r,s.textContent=r,t.append(s)}const a=document.createElement("option");a.value="__custom__",a.textContent="+ Create new category",t.append(a),e&&[...t.options].some(r=>r.value===e)&&(t.value=e)}function J(){R(C,C.value),R(q,q.value)}function ye(){const t=[{value:"all",label:"All"},{value:"low",label:"Low"},...z().map(e=>({value:e,label:e}))];t.some(e=>e.value===d)||(d="all"),O.innerHTML="";for(const e of t){const n=document.createElement("button");n.type="button",n.className=`filter-chip${d===e.value?" active":""}`,n.setAttribute("role","radio"),n.setAttribute("aria-checked",d===e.value?"true":"false"),n.dataset.filter=e.value;const a=document.createElement("span");a.textContent=e.label,n.append(a),n.addEventListener("click",()=>{d=e.value,y()}),O.append(n)}}function V(){const t=me();if(G.innerHTML="",t.length===0){const e=document.createElement("p");e.className="empty-state",e.textContent=N?"No items match your search.":"No items yet. Add your first cupboard item below.",G.append(e);return}for(const e of t){const n=document.createElement("section");n.className="category-section";const a=document.createElement("div");a.className="category-header";const r=document.createElement("span");r.textContent=e.category,a.append(r);const s=document.createElement("div");s.className="items-list",s.setAttribute("role","list");for(const o of e.items){const u=ee.content.firstElementChild.cloneNode(!0),i=u.querySelector('[data-field="name"]'),m=u.querySelector('[data-field="quantity"]'),j=u.querySelector('[data-action="decrease"]'),Y=u.querySelector('[data-action="increase"]'),X=u.querySelector('[data-action="edit"]');i.textContent=o.name,m.value=o.quantity,u.classList.toggle("low",W(o)),m.addEventListener("change",()=>{o.quantity=m.value.trim(),v(),y()}),j.addEventListener("click",()=>{const B=g(o.quantity)??0,E=Math.max(0,B-1);o.quantity=D(E),v(),y()}),Y.addEventListener("click",()=>{const E=(g(o.quantity)??0)+1;o.quantity=D(E),v(),y()}),X.addEventListener("click",()=>{ge(o.id)}),s.append(u)}n.append(a,s),G.append(n)}}function f(t,e="ok"){P.textContent=t,P.dataset.tone=e}function A(){const t=C.value==="__custom__";oe.classList.toggle("hidden",!t),_.required=t,t&&_.focus()}function w(t,e="ok"){T.textContent=t,T.dataset.tone=e}function F(){const t=q.value==="__custom__";re.classList.toggle("hidden",!t),L.required=t,t||(L.value="")}function ge(t){const e=c.items.find(n=>n.id===t);e&&(S=t,J(),H.value=e.name,K.value=e.lowLevel,q.value=e.category,L.value="",F(),w("Update details and save."),typeof l.showModal=="function"?l.showModal():l.setAttribute("open",""))}function h(){S=null,typeof l.close=="function"?l.close():l.removeAttribute("open")}function fe(t){if(t.preventDefault(),!S)return;const e=c.items.find(i=>i.id===S);if(!e){h();return}const n=H.value.trim(),a=K.value.trim(),r=q.value,s=L.value.trim(),o=r==="__custom__"?s:r;if(!n||!a||!o){w("Please complete all fields.","error");return}if(g(a)===null){w("Running low level must be a number.","error");return}if(c.items.some(i=>i.id!==e.id&&i.name.toLowerCase()===n.toLowerCase()&&i.category.toLowerCase()===o.toLowerCase())){w("That item already exists in this category.","error");return}e.name=n,e.lowLevel=a,e.category=o,!p.includes(o)&&!c.customCategories.includes(o)&&(c.customCategories.push(o),c.customCategories.sort((i,m)=>i.localeCompare(m))),v(),h(),y(),f(`Updated ${n}.`,"ok")}function pe(t){t.preventDefault();const e=$.value.trim(),n=ne.value.trim(),a=k.value.trim(),r=C.value,s=_.value.trim();let o=r;if(r==="__custom__"&&(o=s),!e||!n||!a||!o){f("Please complete all fields.","error");return}if(g(n)===null||g(a)===null){f("Quantity and low level must be numbers.","error");return}if(c.items.some(i=>i.name.toLowerCase()===e.toLowerCase()&&i.category.toLowerCase()===o.toLowerCase())){f("That item already exists in this category.","error");return}c.items.push({id:M(),name:e,quantity:n,lowLevel:a,category:o}),!p.includes(o)&&!c.customCategories.includes(o)&&(c.customCategories.push(o),c.customCategories.sort((i,m)=>i.localeCompare(m))),v(),y(),Q.reset(),k.value=b,C.value=o,A(),f(`Added ${e}.`,"ok")}function Ce(){x.addEventListener("input",()=>{N=x.value,V()}),ce.addEventListener("click",()=>{te.scrollIntoView({behavior:"smooth",block:"start"}),window.setTimeout(()=>{$.focus()},200)}),C.addEventListener("change",A),Q.addEventListener("submit",pe),q.addEventListener("change",F),ae.addEventListener("submit",fe),se.addEventListener("click",h),l.addEventListener("cancel",()=>{S=null}),l.addEventListener("click",t=>{t.target===l&&h()})}function y(){J(),ye(),A(),F(),V()}k.value=b;Ce();y();f("Ready.");
